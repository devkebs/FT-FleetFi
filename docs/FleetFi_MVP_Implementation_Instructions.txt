
# FleetFi MVP Implementation Instructions

## Overview:
This document outlines the steps to implement the key functionalities for the FleetFi MVP (Minimum Viable Product) in VSCode, including integration with Trovotech for asset tokenization, wallet management, payouts, and investor dashboards. The system will manage electric vehicle (EV) fleets and display real-time data for investors.

### Steps for Implementation:

---

### 1. Backend Setup with Laravel:
1. **Install Laravel (Backend Framework):**
   - Open VSCode terminal and run the following command to install Laravel:
     ```bash
     composer create-project --prefer-dist laravel/laravel fleetfi-backend
     cd fleetfi-backend
     ```

2. **Set Up the `.env` File:**
   - Configure your environment variables like database credentials, mail configuration, and API keys in the `.env` file.
   - Example:
     ```env
     DB_CONNECTION=mysql
     DB_HOST=127.0.0.1
     DB_PORT=3306
     DB_DATABASE=fleetfi
     DB_USERNAME=root
     DB_PASSWORD=
     ```

3. **Create the Necessary Models and Migrations:**
   - For each entity (e.g., **User**, **Vehicle**, **Asset**, **Payout**, **Token**), create models and migration files in Laravel.
   - Example command:
     ```bash
     php artisan make:model User -m
     php artisan make:model Vehicle -m
     php artisan make:model Token -m
     php artisan make:model Payout -m
     ```

4. **Run Migrations:**
   - After creating migrations, run the following command to migrate the database:
     ```bash
     php artisan migrate
     ```

---

### 2. API Integrations (Trovotech & Qoura):
#### Trovotech Integration:
1. **Create Routes for Trovotech API Endpoints:**
   - Open `routes/api.php` and define the necessary routes (e.g., `wallet/create`, `token/mint`, `payout/initiate`).
   - Example:
     ```php
     Route::post('/wallet/create', [WalletController::class, 'create']);
     Route::post('/token/mint', [TokenController::class, 'mint']);
     Route::post('/payout/initiate', [PayoutController::class, 'initiate']);
     ```

2. **API Controller Logic:**
   - Create controllers for each API endpoint (e.g., **WalletController**, **TokenController**, **PayoutController**).
   - Example of WalletController:
     ```bash
     php artisan make:controller WalletController
     ```
     - Inside the `WalletController.php`:
       ```php
       public function create(Request $request) {
           // Handle wallet creation
           // Call Trovotech API for wallet creation
           $response = Http::post('https://trovotech-api.com/wallet/create', $request->all());
           return response()->json($response->json());
       }
       ```

3. **Implement the API Calls:**
   - Use the **HTTP client** (`Http::post`, `Http::get`) to interact with Trovotechâ€™s API.
   - Example:
     ```php
     use Illuminate\Support\Facades\Http;
     ```

#### Qoura Telemetry Integration:
1. **Setup Telemetry Endpoint:**
   - In `routes/api.php`, define an endpoint to ingest telemetry data.
   - Example:
     ```php
     Route::post('/telemetry', [TelemetryController::class, 'store']);
     ```

2. **Handle Telemetry Data:**
   - Inside `TelemetryController.php`, store the telemetry data.
   - Example:
     ```php
     public function store(Request $request) {
         // Store telemetry data (e.g., battery levels, kilometers)
         $telemetry = new Telemetry();
         $telemetry->asset_id = $request->input('asset_id');
         $telemetry->battery_level = $request->input('battery_level');
         $telemetry->km = $request->input('km');
         $telemetry->time = $request->input('time');
         $telemetry->save();
     }
     ```

---

### 3. User Registration & KYC Integration:
1. **User Registration:**
   - Implement user registration in **UserController**.
   - Example of `register` method:
     ```php
     public function register(Request $request) {
         $user = User::create($request->all());
         // Call Trovotech's wallet API after user creation
         $response = Http::post('https://trovotech-api.com/wallet/create', [
             'name' => $request->name,
             'email' => $request->email,
             'phone' => $request->phone
         ]);
         return response()->json($user);
     }
     ```

2. **KYC Verification Flow:**
   - Create the necessary KYC verification endpoints and logic.
   - Example:
     ```php
     public function initiateKYC(Request $request) {
         // Call external KYC service or internal logic
         $kycStatus = KYC::verify($request->all());
         return response()->json(['status' => $kycStatus]);
     }
     ```

---

### 4. Dashboard for Investors:
1. **Implement Dashboard Endpoint:**
   - Create an endpoint that returns investor data including tokenized assets, revenue, and performance.
   - Example:
     ```php
     Route::get('/dashboard', [DashboardController::class, 'index']);
     ```

2. **Dashboard Logic:**
   - In `DashboardController`, aggregate data from user, wallet, token, and payout models.
   - Example:
     ```php
     public function index(Request $request) {
         $user = $request->user();
         $assets = Asset::where('user_id', $user->id)->get();
         $payouts = Payout::where('user_id', $user->id)->get();
         return view('dashboard', compact('assets', 'payouts'));
     }
     ```

---

### 5. Testing the MVP:
1. **Test API Endpoints:**
   - Use **Postman** or **Insomnia** to test each API endpoint (e.g., wallet creation, token minting, payout initiation).
   - Ensure API responses match expected outcomes.

2. **Unit Testing:**
   - Create unit tests using Laravel's built-in testing framework:
     ```bash
     php artisan make:test WalletTest
     ```
     - Inside `WalletTest.php`:
       ```php
       public function testCreateWallet() {
           $response = $this->postJson('/api/wallet/create', [
               'name' => 'John Doe',
               'email' => 'john@example.com',
               'phone' => '123456789'
           ]);
           $response->assertStatus(200);
       }
       ```

---

### 6. Deployment and Final Setup:
1. **Configure Deployment Settings:**
   - Ensure `.env` file is set up correctly for production (e.g., database, API keys, email service).
   - Deploy the backend to your chosen hosting platform (e.g., **Heroku**, **DigitalOcean**, **AWS**).

2. **Frontend Development (If Applicable):**
   - Develop the frontend to display investor dashboards, vehicle status, and KYC verification.
   - Integrate with the backend API endpoints for real-time data display.

---

### 7. Next Steps:
1. **Integrate Trovotech API:**
   - Finalize API integration for wallet creation, tokenization, payouts, and KYC.

2. **Finalize Telemetry Integration:**
   - Complete the integration with **Qoura** for live vehicle data and ensure correct data flow.

3. **Test the System:**
   - Run tests for all core flows: registration, wallet creation, KYC, token minting, payouts, and dashboards.

---

### Conclusion:
This guide walks through the basic steps for implementing the **FleetFi MVP** in **Laravel** within VSCode, ensuring seamless integration with **Trovotech** and **Qoura** systems. Be sure to implement each feature as described, test rigorously, and deploy the backend to a production environment once everything is functional.
