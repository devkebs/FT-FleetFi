import React, { useState, useEffect } from 'react';
import './LandingPage.css'; // You'll need to create this CSS file

interface FormData {
  name: string;
  email: string;
  phone: string;
  company: string;
  interest: string;
  message: string;
}

export const LandingPage: React.FC = () => {
  const [theme, setTheme] = useState('light');
  const [isScrolled, setIsScrolled] = useState(false);
  const [showScrollTop, setShowScrollTop] = useState(false);
  const [formData, setFormData] = useState<FormData>({
    name: '',
    email: '',
    phone: '',
    company: '',
    interest: 'partnership',
    message: ''
  });
  const [formStatus, setFormStatus] = useState({ type: '', message: '' });
  const [isSubmitting, setIsSubmitting] = useState(false);

  // Configuration
  const whatsappNumber = '2347049195225';
  const whatsappMessage = 'Hello FleetFi! I would like to learn more about your electric mobility solutions.';
  const WEB3FORMS_ACCESS_KEY = '59d41e61-ef15-49ac-9eef-0a42288ee17d';

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 50);
      setShowScrollTop(window.scrollY > 300);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  useEffect(() => {
    document.documentElement.setAttribute('data-theme', theme);
  }, [theme]);

  const toggleTheme = () => setTheme(theme === 'light' ? 'dark' : 'light');

  const scrollTo = (id: string) => {
    document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
  };

  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value
    });
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsSubmitting(true);
    setFormStatus({ type: '', message: '' });

    const formPayload = {
      access_key: WEB3FORMS_ACCESS_KEY,
      subject: `New Contact Form Submission from ${formData.name}`,
      from_name: 'FleetFi Website',
      ...formData
    };

    try {
      const response = await fetch('https://api.web3forms.com/submit', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify(formPayload)
      });

      const result = await response.json();

      if (result.success) {
        setFormStatus({
          type: 'success',
          message: '‚úÖ Thank you! Your message has been sent. We\'ll get back to you within 24 hours.'
        });
        
        setFormData({
          name: '',
          email: '',
          phone: '',
          company: '',
          interest: 'partnership',
          message: ''
        });

        setTimeout(() => {
          setFormStatus({ type: '', message: '' });
        }, 8000);
      } else {
        setFormStatus({
          type: 'error',
          message: '‚ùå Oops! Something went wrong. Please try again or email us directly at partnerships@freenergy.tech'
        });
      }
    } catch (error) {
      setFormStatus({
        type: 'error',
        message: '‚ùå Network error. Please check your connection and try again, or email us at partnerships@freenergy.tech'
      });
    }

    setIsSubmitting(false);
  };

  const openWhatsApp = () => {
    const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;
    window.open(url, '_blank');
  };

  return (
    <div className="landing-page">
      {/* Navigation */}
      <nav className={`nav ${isScrolled ? 'scrolled' : ''}`}>
        <div className="nav-container">
          <div className="logo" onClick={() => scrollTo('home')}>
            <div className="logo-icon">‚ö°</div>
            <div className="logo-text">
              <span>FleetFi</span>
              <span className="logo-subtitle">by Freenergy Tech</span>
            </div>
          </div>
          <ul className="nav-links">
            <li className="nav-link" onClick={() => scrollTo('problem')}>Challenge</li>
            <li className="nav-link" onClick={() => scrollTo('solution')}>Solution</li>
            <li className="nav-link" onClick={() => scrollTo('how-it-works')}>How It Works</li>
            <li className="nav-link" onClick={() => scrollTo('impact')}>Impact</li>
            <li className="nav-link" onClick={() => scrollTo('contact')}>Contact</li>
            <li>
              <button className="btn btn-primary" onClick={() => window.location.href = '/login'}>
                Login / Sign Up
              </button>
            </li>
          </ul>
          <button className="theme-toggle" onClick={toggleTheme}>
            {theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}
          </button>
        </div>
      </nav>

      {/* Hero Section */}
      <section className="hero" id="home">
        <div className="hero-container">
          <div>
            <div className="hero-badge">‚ö° Clean Mobility for Africa</div>
            <h1>
              Electric mobility that helps transport microenterprises <span className="hero-highlight">earn more</span> ‚Äî every day
            </h1>
            <p className="hero-text">
              FleetFi helps commercial transport operators access electric vehicles, cut fuel costs, and increase daily income through pay-as-you-earn clean mobility.
            </p>
            <div className="hero-cta">
              <button className="btn btn-primary" onClick={() => scrollTo('contact')}>
                Partner with us ‚Üí
              </button>
              <button className="btn btn-secondary" onClick={() => scrollTo('how-it-works')}>
                See how it works
              </button>
            </div>
          </div>
          <div className="stats-card">
            <div className="stats-grid">
              <div className="stat-item">
                <div className="stat-number">50%</div>
                <div className="stat-label">Lower Energy Costs</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">100%</div>
                <div className="stat-label">Electric Fleet</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">24/7</div>
                <div className="stat-label">Battery Swap Access</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">0%</div>
                <div className="stat-label">Upfront Cost</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Problem Section */}
      <section className="section" id="problem">
        <div className="section-container">
          <div className="section-header">
            <div className="section-label">The Challenge</div>
            <h2 className="section-title">Fuel costs are crushing transport microenterprises</h2>
            <p className="section-description">
              Over 80% of commercial transport operators in Sub-Saharan Africa spend up to 60% of their daily revenue on fuel. High fuel costs and vehicle maintenance leave little room for growth.
            </p>
          </div>
          <div className="problem-grid">
            <div className="problem-card">
              <div className="problem-icon">üí∏</div>
              <h3>60% of revenue on fuel</h3>
              <p>Operators spend the majority of earnings on expensive petrol, leaving minimal profit.</p>
            </div>
            <div className="problem-card">
              <div className="problem-icon">üîß</div>
              <h3>High maintenance costs</h3>
              <p>ICE vehicles require frequent servicing, eating into already thin margins.</p>
            </div>
            <div className="problem-card">
              <div className="problem-icon">üö´</div>
              <h3>No access to clean vehicles</h3>
              <p>Upfront costs of EVs are prohibitively high for microenterprises.</p>
            </div>
          </div>
        </div>
      </section>

      {/* Solution Section */}
      <section className="section section-alt" id="solution">
        <div className="section-container">
          <div className="section-header">
            <div className="section-label">Our Solution</div>
            <h2 className="section-title">Pay-as-you-earn electric mobility</h2>
            <p className="section-description">
              FleetFi makes electric vehicles accessible through a tokenized ownership model. Operators pay per ride, investors earn returns, and everyone benefits from clean energy.
            </p>
          </div>
          <div className="solution-grid">
            <div className="solution-card">
              <div className="solution-icon">‚ö°</div>
              <h3>Zero upfront cost</h3>
              <p>No large capital investment required. Start earning from day one with pay-per-trip pricing.</p>
            </div>
            <div className="solution-card">
              <div className="solution-icon">üîã</div>
              <h3>Battery swap network</h3>
              <p>Instant battery swaps mean zero downtime. Keep vehicles moving and maximize earnings.</p>
            </div>
            <div className="solution-card">
              <div className="solution-icon">üí∞</div>
              <h3>Fractional ownership</h3>
              <p>Investors can own tokens representing shares in the fleet, earning returns from operations.</p>
            </div>
            <div className="solution-card">
              <div className="solution-icon">üìä</div>
              <h3>Real-time tracking</h3>
              <p>Monitor vehicle performance, battery health, and earnings through our platform.</p>
            </div>
          </div>
        </div>
      </section>

      {/* How It Works Section */}
      <section className="section" id="how-it-works">
        <div className="section-container">
          <div className="section-header">
            <div className="section-label">How It Works</div>
            <h2 className="section-title">Three simple steps to clean mobility</h2>
          </div>
          <div className="how-it-works-grid">
            <div className="step-card">
              <div className="step-number">01</div>
              <h3>Sign up & get verified</h3>
              <p>Register as an operator, complete KYC, and get approved to access the fleet.</p>
            </div>
            <div className="step-card">
              <div className="step-number">02</div>
              <h3>Start operating</h3>
              <p>Get assigned an EV, swap batteries at our stations, and start earning immediately.</p>
            </div>
            <div className="step-card">
              <div className="step-number">03</div>
              <h3>Pay as you earn</h3>
              <p>Revenue is automatically distributed: operator earnings, investor returns, and platform fees.</p>
            </div>
          </div>
        </div>
      </section>

      {/* Impact Section */}
      <section className="section section-alt" id="impact">
        <div className="section-container">
          <div className="section-header">
            <div className="section-label">Our Impact</div>
            <h2 className="section-title">Creating sustainable livelihoods</h2>
            <p className="section-description">
              FleetFi isn't just about electric vehicles‚Äîit's about empowering communities, reducing emissions, and building a sustainable future for African transport.
            </p>
          </div>
          <div className="impact-grid">
            <div className="impact-card">
              <div className="impact-stat">+40%</div>
              <div className="impact-label">Increase in daily income</div>
              <p>Operators earn more by spending less on energy and maintenance.</p>
            </div>
            <div className="impact-card">
              <div className="impact-stat">-70%</div>
              <div className="impact-label">CO‚ÇÇ emissions reduction</div>
              <p>Every EV on the road cuts carbon emissions dramatically.</p>
            </div>
            <div className="impact-card">
              <div className="impact-stat">100%</div>
              <div className="impact-label">Renewable energy powered</div>
              <p>Our battery swap stations run on clean, biogas-generated electricity.</p>
            </div>
          </div>
        </div>
      </section>

      {/* Contact Form Section */}
      <section className="section contact-form-section" id="contact">
        <div className="section-container">
          <div className="section-header">
            <div className="section-label">Get In Touch</div>
            <h2 className="section-title">Let's build the future of mobility together</h2>
            <p className="section-description">
              Whether you're an operator, investor, or partner, we'd love to hear from you.
            </p>
          </div>
          <div className="contact-grid">
            <form className="contact-form" onSubmit={handleSubmit}>
              <div className="form-row">
                <input
                  type="text"
                  name="name"
                  placeholder="Full Name *"
                  value={formData.name}
                  onChange={handleInputChange}
                  required
                  className="form-input"
                />
                <input
                  type="email"
                  name="email"
                  placeholder="Email Address *"
                  value={formData.email}
                  onChange={handleInputChange}
                  required
                  className="form-input"
                />
              </div>
              <div className="form-row">
                <input
                  type="tel"
                  name="phone"
                  placeholder="Phone Number"
                  value={formData.phone}
                  onChange={handleInputChange}
                  className="form-input"
                />
                <input
                  type="text"
                  name="company"
                  placeholder="Company (Optional)"
                  value={formData.company}
                  onChange={handleInputChange}
                  className="form-input"
                />
              </div>
              <select
                name="interest"
                value={formData.interest}
                onChange={handleInputChange}
                className="form-select"
              >
                <option value="partnership">Partnership Inquiry</option>
                <option value="operator">Become an Operator</option>
                <option value="investor">Investment Opportunity</option>
                <option value="other">General Inquiry</option>
              </select>
              <textarea
                name="message"
                placeholder="Tell us more about your interest... *"
                value={formData.message}
                onChange={handleInputChange}
                required
                rows={6}
                className="form-textarea"
              />
              {formStatus.message && (
                <div className={`form-status ${formStatus.type}`}>
                  {formStatus.message}
                </div>
              )}
              <button
                type="submit"
                className="btn btn-primary btn-large"
                disabled={isSubmitting}
              >
                {isSubmitting ? 'Sending...' : 'Send Message ‚Üí'}
              </button>
            </form>
            <div className="contact-info">
              <div className="contact-card">
                <h3>üìß Email Us</h3>
                <p>partnerships@freenergy.tech</p>
              </div>
              <div className="contact-card">
                <h3>üìç Location</h3>
                <p>Lagos, Nigeria</p>
              </div>
              <div className="contact-card">
                <h3>üí¨ WhatsApp</h3>
                <button className="btn btn-secondary" onClick={openWhatsApp}>
                  Chat with us ‚Üí
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Footer */}
      <footer className="footer">
        <div className="footer-container">
          <div className="footer-grid">
            <div>
              <h3>FleetFi</h3>
              <p className="footer-description">
                Clean mobility solutions for African transport microenterprises.
              </p>
            </div>
            <div>
              <h4>Product</h4>
              <ul className="footer-links">
                <li><a href="#problem">The Challenge</a></li>
                <li><a href="#solution">Our Solution</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#impact">Impact</a></li>
              </ul>
            </div>
            <div>
              <h4>Company</h4>
              <ul className="footer-links">
                <li><a href="#contact">Contact</a></li>
                <li><a onClick={() => window.location.href = '/login'}>Login</a></li>
              </ul>
            </div>
            <div>
              <h4>Connect</h4>
              <ul className="footer-links">
                <li><a href="mailto:partnerships@freenergy.tech">Email</a></li>
                <li><a href="#" onClick={openWhatsApp}>WhatsApp</a></li>
              </ul>
            </div>
          </div>
          <div className="footer-bottom">
            <p>&copy; 2025 Freenergy Tech. All rights reserved.</p>
          </div>
        </div>
      </footer>

      {/* WhatsApp Widget */}
      <button className="whatsapp-widget" onClick={openWhatsApp} title="Chat on WhatsApp">
        üí¨
      </button>

      {/* Scroll to Top */}
      {showScrollTop && (
        <button className="scroll-to-top" onClick={scrollToTop}>
          ‚Üë
        </button>
      )}
    </div>
  );
};

export default LandingPage;
